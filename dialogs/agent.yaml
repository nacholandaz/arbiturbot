initial_user_message:
    type: 'text'
    text: 'User generated text'
    next_interaction: start

start:
    type: 'text'
    text: 'Hola ${name} 🙋‍♀'
    requires_user_response: 'false'
    next_interaction: 'presentation'

presentation:
    type: 'text'
    text: 'Soy Arbi, estoy aquí para lo que necesites!'
    requires_user_response: 'false'
    next_interaction: 'agent_options'

agent_options:
    type: 'multiple_choice'
    text: "Esta es la lista de comandos disponibles para empezar a trabajar 👍\n1️⃣Teclea el número 1 para ver tus conversaciones pendientes\n2️⃣Teclea el número 2 para ver tu lista de usuarios\n3️⃣Teclea el número 3 para registrar un nuevo usuario\n❓Escribe “ayuda” para más información, estoy a tus órdenes! 😀"
    requires_user_response: 'true'
    next_interaction: 'agent_options'
    next_interaction: {
        '1':  pending_users,
        '2':  my_users,
        '3':  register_user_question,
        'ayuda': end_demo,
    }
    next_interaction_failure: end_demo

register_user_question:
    type: 'text'
    text: "Ok! Para agregar usuarios, escribe el nombre completo y entre paréntesis el número de teléfono.\n\nEjemplo:\n*+u* Luis Miguel (81 1234 5678)"
    save_answer_context: 'new_user_info'
    requires_user_response: 'true'
    next_interaction: pre_register_user

#This converts the context 'new_user_info' to the different context data
pre_register_user:
    type: 'pre_register_user'
    requires_user_response: 'false'
    next_interaction: confirm_user

confirm_user:
    type: 'multiple_choice'
    text: "Ok! Entonces el nuevo usuario es:\n\n👤${new_user_info_name}\n☎️${new_user_info_phone}\n${new_user_info_country}\n\n¿Es correcto?\n1️⃣Sí\n2️⃣No"
    requires_user_response: 'true'
    next_interaction: {
        '1':  confirm_user_yes,
        '2':  register_user_question,
    }
    next_interaction_failure: confirm_user

confirm_user_yes:
    type: 'register_user'
    requires_user_response: 'false'
    next_interaction: choose_options_confirm

choose_options_confirm:
    type: 'text'
    text: "Elegiste 1"
    requires_user_response: 'false'
    next_interaction: describe_user_register

describe_user_register:
    type: 'text'
    text: "Ok! Este usuario ya está en la base de datos:\nNuevo cliente: NO\nEstatus: Reporte abierto"
    requires_user_response: 'false'
    next_interaction: explain_arbirtur


explain_arbirtur:
    type: 'text'
    text: "1️⃣Si quieres mandarle un mensaje al usuario, escríbe m=, seguido por el mensaje\n\nEjemplo:\nm= Hola, hablo por parte de lo que me preguntaste\n2️⃣De otra forma, escribe 'X'"
    requires_user_response: 'false'
    next_interaction: redirect_chat_interaction

redirect_chat_interaction:
    type: 'redirect_message'
    requires_user_response: 'true'
    quit_keyword: 'X'
    next_interaction_when_exit: quit_conversation

quit_conversation:
    type: 'text'
    text: '{Aqui va bloque de generar recordatorios}'
    requires_user_response: 'false'
    next_interaction: show_user_list_after_register

show_user_list_after_register:
    type: 'owned_users_threads'
    text: 'Te recuerdo que tienes *conversaciones pendientes:*'
    requires_user_response: 'false'
    next_interaction: agent_options

user_list:
    type: 'owned_users_threads'
    text: 'Tienes *conversaciones pendientes:*'
    requires_user_response: 'false'
    next_interaction: end_demo

end_demo:
    type: 'text'
    text: 'Aqui termina el demo.'
    finishes_conversation: 'true'
